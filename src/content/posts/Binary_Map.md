---
title: 二分图
published: 2025-07-07
tags: [GRAPH]
category: Knowledge
draft: false
---

# 前置知识：[网络流](https://fishergogo.github.io/2025/05/12/Net_Flow/)

# 定义

- 设有一个无向图 $G=(V,E)$ ，若我们可以将其分为两个点集 $V_{1},V_{2}$ ，使得 $V_{1}\cap V_{2}=\varnothing$ 且 $V_{1}\cup V_{2}=V$ ，还有 $\forall (u,v)\in E$ ，都有 $u\in V_{1}$ 和 $v\in V_{2}$ 
- 简单来讲，就是把原点集分为两个部分，两个点集内部没有相连的边

## 性质

- 我们从一个点开始走，每经过一条边都会更换一个所在集合，那么说明我们从一个点出发必须经过偶数条边才能回到原点，所以图上没有奇环。反过来讲，如果图没有奇环，那么对其进行黑白染色就可以得到一个二分图
- 所以判定二分图的充要条件是：**不存在奇环**

# 二分图匹配

- 给定二分图 $G=(V,E)$ ，若边集 $M\in E$ 满足任意两条边不交于同一点，我们称 $M$ 为 $G$ 的一组**匹配**，匹配大小为 $|M|$ 
- 若 $|V_{1}|=|V_{2}|=|M|$ ，我们称 $M$ 为**完美匹配**

## 最大匹配

### $\mathrm{Dinic}$

- 求解二分图的经典算法应该是匈牙利算法，我们现在尝试用网络流来求解
- 在匹配中一个点最多与一条边相连，所以其度数 $\le1$ ，所以我们从源点 $S$ 向 $V_{1}$ 连一条容量为 $1$ 的边，从 $V_2$ 向汇点 $T$ 连一条容量为 $1$ 的边，再给所有原图上的边连一条 $V_{1}\rightarrow V_{2}$ 容量为 $1$ 的边，随后 $S\rightarrow T$ 的最大流既最大匹配
- 复杂度为 $O(m\sqrt{n})$ 

### 最大多重匹配

- 节点 $u$ 可以与不超过 $L_{u}$ 条边相连
- 我们只需要把 $S\rightarrow V_1$ 的边的容量换为 $L_{u}$ ， $V_2\rightarrow T$ 同理

### 带权最大匹配

- 最小权最大匹配，我们跑最小费用最大流
- 最大权最大匹配，我们跑最大费用最大流，只需要权值取反求最小费用最大流

# 二分图相关问题

## 最小点覆盖集

- 点覆盖集：在一个二分图中，若点集 $C\in V$ 满足任意 $(u,v)\in E$ 都有 $u\in C$ 或 $v\in C$ ，那么称其为点覆盖集
- 对于求最小点覆盖集，我们有柯尼希定理：
$$最小点覆盖=最大匹配$$
- 那么求最大匹配即可
- 然后我们要找出点集，我们这么做：
	- 我们再残量网络上从源点 $S$ 开始遍历，能被遍历到的点我们归到 $T1$ ，反之归到 $T2$ 
	- 那么对于 $U$ 中属于 $T2$ 的点加上 $V$ 中属于 $T1$ 的点组成了最小点覆盖集
- 同时我们也可以用集合划分模型来解决，我们将一部点的状态取反，即假如左部点与 $S$ 连通表示其不属于 $C$ ，右部点与 $T$ 连通表示其不属于 $C$ ，那么此时限制变为：如果左部点 $u$ 与 $S$ 连通，且 $u,v$ 之间有边，但右部点 $v$ 也与 $T$ 连通，那么此时 $u,v$ 都不属于 $C$ ，不合法
- 我们此时可以这样建模，我们连接 $S\rightarrow u$ 容量为 $1$ ，连接 $v\rightarrow T$ 容量为 $1$ ，同时对于 $(u,v)\in E$ ，我们连接 $u\rightarrow v$ 容量为 $+\infty$ ，那么此时割掉连接源点汇点任意一条边都代表将其放入 $C$ 的代价，那么最小割就是我们的答案，既最大流
- 此时求出点集与上边相同

## 最大独立集

- 独立集：若有点集 $I$ ，满足其中任意两点不直接相连，称其为独立集
- 最大独立集对于 $V$ 减去最小点覆盖集，既 $V$ 减去最大匹配数
- 一般有这样的问题：
	- 社交网络中无冲突群体选择：假设在一个社交活动中，有两组人（例如，A公司的员工和B公司的员工）。由于竞争关系或其他原因，A公司的某些员工与B公司的某些员工之间存在“不和”关系。现在需要从这两组人中挑选出尽可能多的人参加一个合作项目，要求是挑选出的人里面，任意两人之间都不能有“不和”关系。
	- 棋盘的棋子布局：在一个国际象棋棋盘上，最多可以放置多少个“车”，使得它们之间互相不能攻击？
- 二分图最大独立集问题，其本质是**在一个具有两类元素和冲突关系的模型中，进行最大化的、无冲突的选择**。

## 最大团

- 团：一个图的导出子图有任意 $u,v\in V',u\in U,v\in V$ 均有 $(u,v)\in E'$ ，换句话说就是这个团中任意两个不同部的点均有边
- 最大团对于其补图的最大独立集

## 某部点的极值

- 有些题目让我们求使得某部点数量尽可能多的**最小点覆盖集**，**最大独立集**或**最大团**
- 我们套用集合划分模型，那么问题转化为：我们想尽可能割掉 $S$ 与左部点的连边或者右部点与 $T$ 的连边，先讨论前者
- 假如我们希望最大团左部点尽量多，根据我们有 
$$最大团=补图最大独立及=补图最小点覆盖的补集$$
- 所以我们希望补图的最小点覆盖集的左部点尽量少，既被割掉的左部点尽量多，考虑我们之前的集合划分模型的定义，我们将 $S\rightarrow u$ 的代价定义为 $c$ ，那么 $v\rightarrow T$ 的代价定义为 $c+1$ ，那么此时就会优先割掉左部点
- 对于 $c$ 的约束：为了保证总割边不变，既此时找到的**必须是**最小点覆盖，既我们不希望因为修改了容量导致我们选择了 $k+1$ 的点覆盖集而不是 $k$ 的点覆盖集，我们来比较极端情况：
	- 大小为 $k$ 的最昂贵方案，既选 $k$ 个右部点，代价为 $k\times(c+1)$
	- 大小为 $k+1$ 的最便宜方案，既选 $k+1$ 个左部点，代价为 $(k+1)\times c$
	- 我们必须保证 $(k+1)\times c>k\times(c+1)$ ，得到 $c>k$ 
	- 又或者可以写成 $c\le (n=min(|V_{1}|,|V_{2}|))$ ，$c>n-1$

