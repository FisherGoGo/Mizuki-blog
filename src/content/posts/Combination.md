---
title: 组合数学
published: 2025-08-04
tags: [MATH]
category: Knowledge
draft: false
---

# 枚举组合
## 加法与乘法

- 若 $A_{i}\cap A_{j}=\varnothing\;, i\ne j$ ，有
$$|\bigcup_{i=1}^{k} A_{i}|=\sum\limits_{i=1}^{k}|A_{i}|$$
- 若事件各自独立，有
$$|A_{1}\times A_{2}\times \ldots\times A_{k}|=|A_{1}|\cdot|A_{2}|\ldots|A_{k}|$$

# 排列

- 从 $n$ 个不同元素之间取出 $k$ 个元素，按照一定顺序进行排列，其方案数为 $P(n,k)$ 或者 $A_{n}^{k}$ 表示
$$P(n,k)=\frac{n!}{(n-k)!}$$
## 不尽相异元素排列

- 当要排列的元素存在重复时，如有 $n_{1}$ 个元素属于类型 $1$ 等，且 $\sum\limits n_{i}=n$ ，其排列总数为：
$$\frac{n!}{n_{1}!n_{2}!\ldots n_{k}!}$$
## 圆排列

- 将 $n$ 个不同的元素排列到一个圆环上，与线性排列不同，圆排列中的排列如果可以通过旋转互相得到，则视为同一种排列，方案数为 $\frac{n!}{n}=(n-1)!$ 
- 从 $n$ 个不同物品中取 $m$ 个的全排列 $\frac{n!}{(n-m)!m}$
## 不尽相异元素全排列

- 设元素 $a_{1},a_{2},\ldots,a_{n}$ 各不相同，从有限多重集合 $\{k_{1}a_{1},k_{2}a_{2},\ldots,k_{n}a_{n}\}$ 中取 $r$ 个元素，存在至少一个 $k_{i}<r$ ，排列数为：
$$\frac{r!}{k_{1}!k_{2}!\ldots k_{n}!}$$
# 组合

- 从 $n$ 个不同元素之中取 $k$ 个元素，不考虑排列顺序，其方案数为 $C(n,k)$ 或者 $\left(\begin{matrix}n\\k\end{matrix}\right)$ 表示 
$$C(n,k)=\frac{n!}{k!(n-k)!}$$
## 可重复组合

- 从 $n$ 个物品中，可重复地取 $k$ 个物品，这个问题也等价于求 $x_{1}+x_{2}+\ldots+x_{n}=k$ 的非负整数解的个数，其中 $x_{i}$ 表示第 $i$ 种物品被取得数量
- **隔板法**：想象我们有 $k$ 个相同的物品，和 $n-1$ 个隔板，我们需要讲物品与隔板排成一列，$n-1$ 个隔板会把物品分成 $n$ 组，对应 $n$ 个物品数量，总共有 $n+k-1$ 个位置，选择 $n-1$ 个位置，那么答案是 
$$H_{n}^{k}=C_{n+k-1}^{k}=\left(\begin{matrix}k+n-1\\n-1\end{matrix}\right)=\left(\begin{matrix}k+n-1\\k\end{matrix}\right)$$
## 不相邻组合

- 从 $\{1,2,3,\ldots,n\}$ 中取 $m$ 个不相邻组合，其组合数为 $C_{n-m+1}^{m}$ 
- 此时我们有 $m$ 个被选中的数与 $n-m$ 个未被选中的数，我们将 $n-m$ 个未被选中的数拿出来排成一列，只有他们的空隙中与两端可以插入仅一个数，那么此时有 $n-m+1$ 个空位，那么就是在这 $n-m+1$ 个空位中选 $m$ 个
## 常见组合数公式

- $C(n,m)=C(n-1,m)+C(n-1,m-1)$
- $C(n,m)=C(n,n-m)$
- $C(n,m+1)= \frac{n-m}{m+1} C(n,m)$
# 常用公式和定理

## 二项式定理

$$(x+y)^{n}=\sum\limits C_{n}^{i} x^{n-i}y^{i}$$
## 常见恒等式

 $$\sum\limits_{i=0}^{n}C_{n}^{i}=2^{n}$$
$$\sum\limits_{i=0}^{n}(-1)^{i}C_{n}^{i}=0$$
$$\sum\limits_{i=0}^{n} 2^{i}C_{n}^{i}=3^{n}$$
## 帕斯卡恒等式

$$C_{n}^{k}=C_{n-1}^{k}+C_{n-1}^{k-1}$$
- 考虑从 $n$ 个元素中选 $k$ 个，我们可以在这 $n$ 个元素中指定特殊元素 $A$，那么分为：
	- 不包含 $A$ 的组合： $C_{n-1}^{k}$ 
	- 包含 $A$ 的组合： $C_{n-1}^{k-1}$ 
## 吸收/提取恒等式

$$kC_{n}^{k}=nC_{n-1}^{k-1}$$
- 考虑从 $n$ 个人中选 $k$ 人，再从 $k$ 人中选一个
## 范德蒙德恒等式

$$\sum\limits_{j=0}^{k}\left(\begin{matrix}m\\j\end{matrix}\right)\left(\begin{matrix}n\\k-j\end{matrix}\right)=\left(\begin{matrix}m+n\\k\end{matrix}\right)$$
- 假设有两个集合，一个有 $m$ 个元素，一个有 $n$ 个元素，我们要从这两个集合共 $m+n$ 个元素中选出 $k$ 个
## 曲棍球棒恒等式

$$\sum\limits_{i=r}^{n}\left(\begin{matrix}i\\r\end{matrix}\right)=\left(\begin{matrix}n+1\\r+1\end{matrix}\right)$$
- 考虑从集合 $\{1,2,\ldots,n+1\}$ 中选择 $r+1$ 个数，方案数为右式
- 我们也可以按照所选中的最大的数来分类讨论，假设选出的 $r+1$ 个数中最大的是 $i+1$ ，那么方案数为 $\left(\begin{matrix}i\\r\end{matrix}\right)$ ，累加得到左式
## 杨辉三角第 $n$ 行和

$$\sum\limits_{k=0}^{n}\left(\begin{matrix}n\\k\end{matrix}\right)=2^{n}$$
- 从 $n$ 个元素中选出任意数量的元素组成一个子集，把所有可能大小的子集数量相加得到
## 鸽巢原理

- 鸽巢原理，又称抽屉原理，用于证明存在性而非直接计数
	- 第一形式：若将 $n+1$ 个元素（鸽子）放入 $n$ 个容器（鸽巢）中，则至少有一个容器有两个物品
	- 第二形式：若将 $N$ 个数放入 $k$ 个物品，则至少有一个容器中至少有 $\left\lceil\dfrac{N}{k}\right\rceil$ 
- 一般用于构造合法性
- 例题：给定 $N$ 个整数，找到一个非空子集，使其元素之和是 $N$ 的倍数
	- 我们设 $S_{i}=\sum\limits_{j=1}^{i} a_{j}$ ，我们将他们对 $N$ 取模，得到 $S_{1}\pmod{N},S_{2}\pmod{N}\ldots$ 
	- 若存在 $S_{i}\equiv 0\pmod{N}$ ，那么 $a_{1}\ldots a_{i}$ 这个子集即为答案
	- 反之，这时候我们相当于有 $N$ 个鸽子，有 $N-1$ 个抽屉（$1,2\ldots,N-1$），根据鸽巢原理，必有 $S_{i}\equiv S_{j}\pmod{N}$ ，所以 $(S_{j}-S_{i})|N$ ，那么 $i$ 到 $j$ 即为答案
## 容斥原理

$$|\bigcup_{i=1}^{n}S_{i}|=\sum\limits_{\varnothing\ne I\in\{1,\ldots,n\}}(-1)^{|I|-1}|\bigcap_{i\in I}S_{i}|$$
- 补集形式：一般是**目标一个都不满足**时的情况
$$|\bigcap_{i=1}^{n}\overline{S_{i}}|=|U|-|\bigcup_{i=1}^{n}S_{i}|$$

## 错排问题

- 给定一个有 $n$ 个元素的排列，如果在这个排列中所有元素都不在自己的位置上，那么这个排列被称为全错位排列，简称**错排**，我们通常用 $D_{n}$ 或者 $!n$ 来表示 $n$ 个元素的错排数
- 我们用**递推法**来得到公式：
	- 我们考虑把第 $n$ 个元素放到第 $k$ 个位置，再来考虑第 $k$ 个元素的去向，这时候分成两种情况
		- $k$ 刚好放到了第 $n$ 个位置：那么此时 $n$ 与 $k$ 交换了位置，剩下 $n-2$ 个元素要进行错排，既剩下的情况方案数是 $D_{n-2}$
		- $k$ 没有放到第 $n$ 个位置，对于剩下 $n-1$ 个元素而言，因为 $k$ 不能去 $n$ 号位，所以此时我们把其*重命名*为 $n$ ，那么现在就是 $n-1$ 个元素进行错排，方案数为 $D_{n-1}$
	- 对于 $n$ 放的位置有 $n-1$ 个选择，所以我们得到总递推式
$$D_{n}=(n-1)(D_{n-1}+D_{n-2})\quad(n\ge3)\quad D_{1}=0,D_{2}=1$$
- 我们还可以通过**容斥原理**得到另外一个公式：
	- 根据容斥原理我们有：
$$D_{n}=|U|-(至少一个正确)+(至少两个正确)-(至少三个正确)+\ldots$$
- 
	- 至少一个元素位置正确：我们先选出一个元素让他位置正确，有 $\left(\begin{matrix}n\\1\end{matrix}\right)$ 种选法，剩下 $n-1$ 个元素任意排列，有 $(n-1)!$ 种方法，总数为： $\frac{n!}{1!(n-1)!}(n-1)!=\frac{n!}{1}$
	- 以此类推至少有 $k$ 个元素正确方案数为：$\frac{n!}{k!}$ 
	- 组合起来我们得到通项公式：
$$D_{n}=n!\left( \frac{1}{0}-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+\ldots+\frac{(-1)^{n}}{n!}\right)=n!\sum\limits_{i=0}^{n} \frac{(-1)^{n}}{i!}$$
- 关于第二个公式我们发现其与 $e^{x}$ 在 $x=-1$ 的泰勒展开几乎一致，就是多了个 $n!$ ，那么有
$$\lim_{n \rightarrow\infty} \frac{D_{n}}{n!}=\frac{1}{e}$$
- 既一个排列是错排的概率在 $n$ 趋于无穷大时接近 $\frac{1}{e}$ 
- 我们也可以这样子估算：
$$D_{n}=\mathbf{round} \left( \frac{n!}{e} \right)\quad n\ge1$$

## 卢卡斯定理

- 设 $p$ 是一个素数，$n$ 与 $k$ 是非负整数，我们将 $n$ 与 $k$ 表示为 $p$ 进制数
$$n=n_{m}p^{m}+n_{m-1}p^{m-1}+\ldots+n_{1}p+n_{0}$$
$$k=k_{m}p^{m}+k_{m-1}p^{m-1}+\ldots+k_{1}p+k_{0}$$
- 卢卡斯定理给出以下等式
$$\left(\begin{matrix}n\\k\end{matrix}\right)\equiv\prod_{i=0}^{m}\left(\begin{matrix}n_{i}\\k_{i}\end{matrix}\right)\pmod{p}$$
- 若出现 $n_{i}<k_{i}$ ，则 $\left(\begin{matrix}n_{i}\\k_{i}\end{matrix}\right)=0$ 
- 那么我们有一个常用推论： $\left(\begin{matrix}n\\m\end{matrix}\right)$ 为奇数当且仅当 $n\land m=m$ 
# 关键数列及其组合解释 

# 斐波那契数列

$$F_{n}=F_{n-1}+F_{n-2}$$
## 性质

- 从第二项开始，每个奇数项的平方都比前后两项之积少 $1$ ，每个偶数项的平方都比前后两项之积多 $1$ 
- 集合 $\{1,2,\dots,n\}$ 种所有不包含相邻正整数的子集个数是 $F_{n+2}$ 
- $F_{1}+F_{3}+F_{5}+\ldots+F_{2n-1}=F_{2n}-F_{2}+F_{1}$
- $F_{2}+F_{4}+F_{6}+\ldots+F_{2n}=F_{2n+1}-F_{1}$
- $F_{1}^{2}+F_{2}^{2}+F_{3}^{2}+\ldots+F_{n}^{2}=F_{n}\times F_{n+1}$
- $\frac{F_{2n}}{F_{n}}=F_{n-1}+F_{n+1}$ 
- $F_{n-1}\times F_{n+1}-F_{n}^{2}=(-1)^{n}$
# 卡特兰数

## 公式

- 卡特兰数有非线性递推公式，标准形式为：
$$C_{n+1}=\sum\limits_{i=0}^{n}C_{i}C_{n-i}$$
- 或者对于 $n\ge 1$ ：
$$C_{n}=\sum\limits_{i=0}^{n-1}C_{i}C_{n-1-i}$$
- 这个式子表明了一个规模为 $n$ 的卡特兰结构，可以选择一个分割点分成规模为 $i$ 与规模为 $n-i-1$ 的子结构，将所有可能的分割点求和既是总方案数，是许多组合问题的内在逻辑
- 除了卷积形式还有一个线性递推关系：
$$C_{n}= \frac{2(2n-1)}{n+1}C_{n-1}$$
- 有或者我们可以用二项式系数表示
$$C_{n}=\frac{1}{n+1}\left(\begin{matrix}2n\\n\end{matrix}\right)=\left(\begin{matrix}2n\\n\end{matrix}\right)-\left(\begin{matrix}2n\\n-1\end{matrix}\right)=\frac{1}{2n+1}\left(\begin{matrix}2n+1\\n\end{matrix}\right)$$
- 我们可以通过一个经典的组合论证——**反射原理**来证明：
	- 我们在一个 $n\times n$ 的网格中从 $(0,0)$ 走到 $(n,n)$ 的路径为模型
	- 总路径数：任何一条从 $(0,0)$ 到 $(n,n)$ 且只用向右和向上移动的路径，总共需要 $2n$ 步，其中包含 $n$ 步右和 $n$ 步上，依次，总路径数大于在 $2n$ 个位置中选择 $n$ 个位置向上，即 $\binom{2n}{n}$
	- 我们定义*好路径*是不穿过主对角线 $y=x$ 的上方的路径，反之为坏，此时卡特兰数正是统计*好路径*的数量
	- 反射原理的应用：我们的目的是计算坏路径的数量，考虑一条坏路径，它必定会接触到对角线 $y=x$ 上方的第一条线，既 $y=x+1$ ，找到这条路径第一次接触到 $y=x+1$ 的点，记为 $P$ ，将从起点 $(0,0)$ 到点 $P$ 的这段路径，关于直线 $y=x+1$ 做轴对称变换，那么此时源路径从 $(0,0)$ 到 $P$ 变成了 $(-1,1)$ 到 $P$ ，路径剩余部分不变
	- 那么此时每一条从 $(0,0)$ 到 $(n,n)$ 的坏路径都唯一对应着一条从 $(-1,1)$ 到 $(n,n)$ 的路径，这个路径的方案数是 $\binom{2n}{n-1}$ 
$$\begin{aligned} \binom{2n}{n} - \binom{2n}{n-1}   
 =&\frac{(2n)!}{n!n!} - \frac{(2n)!}{(n-1)!(n+1)!}
\\&= \frac{(2n)!}{n!(n-1)!} \left( \frac{1}{n} - \frac{1}{n+1} \right) 
\\&= \frac{(2n)!}{n!(n-1)!} \frac{1}{n(n+1)} 
\\&= \frac{1}{n+1} \frac{(2n)!}{n!n!} 
\\&= \frac{1}{n+1} \binom{2n}{n} \end{aligned}$$
- 以下是卡特兰数的前十项（从 $0$ 开始）：
$$1,1,2,5,14,42,132 ,429,1430,4862$$
## 组合模型

- 卡特兰数有广泛的应用性，可以套用于许多模型，核心结构可以概括为**无交叉的嵌套分解** 
### 戴克路径与合法括号序列

- **定义**：
	- **合法括号序列**：一个由 $n$ 个左括号和 $n$ 个右括号组成的字符串，如果在任意前缀中左括号的数量总是大于等于右括号的数量，那么称序列合法
	- **戴克路径**：上文提到的不穿过对角线的路径
- **等价性**：这两个模型完全等价，我们可以建立一个映射，左括号对应向右一步，右括号对应向上一步，那么其约束等价于 $x_{i}\ge y_{i}$ ，可发现是等价的
- **递推关系证明**：考虑一个长度为 $2n$ 的合法括号序列，第一个左括号必然与某个位置 $2k+1$ 的右括号相匹配，这个匹配的右括号将整个序列分割成 $(A)B$ 的形式：
	- 其中 $A$ 必须是一个合法的括号序列，长度为 $2k$ 其中 $k$ 可以从 $0$ 选到 $n-1$ ，$A$ 的方案数是 $C_{k}$ 
	- 且 $B$ 也得是一个合法括号序列，同上方案数为 $C_{n-1-k}$ 
	- 由于 $A$ 与 $B$ 的构造是独立的，根据乘法原理与加法原理，得到卡特兰数的递推式：
$$C_{n}=\sum\limits_{k=0}^{n-1}C_{k}C_{n-1-k}$$
### 满二叉树计数

- $C_{n}$ 是有 $n$ 个内部节点（度为 $2$ 的点）的满二叉树数量
- **递推关系证明**：考虑一颗有 $n$ 个内部节点的满二叉树
	- 根节点必然是一个满二叉树
	- 左子树和右子树也必须是一个满二叉树
	- 假如左子树有 $i$ 个内部节点，方案数为 $C_{i}$ ，那么右子树为 $C_{n-1-i}$ ，同上乘法与加法原理得到递推公式
### 多边形三角剖分与无交叉弦

- $C_{n}$ 是将一个凸 $(n+2)$ 边形通过 $n-1$ 条互不相交的对角线分割成 $n$ 个三角形的方案数
- **递推关系证明**：考虑将一个凸 $(n+2)$ 边形，其顶点依次为 $v_{1},v_{2},\ldots,v_{n+2}$ ，我们固定一条边如 $v_{1}v_{n+2}$ 在任何一个三角形剖分中，这个边必须与另外一个顶点构成一个三角形，这个三角形会将原来的多边形分割成两个更小的多边形，其中一个方案数为 $C_{k-2}$ 另外一个为 $C_{n+1-k}$ ，经过变量替换得到递推式
- 无交叉弦：$C_{n}$ 是在圆周上的 $2n$ 个点两两配对，连接成 $n$ 条互不相交的弦的方案数，这与多边形三角剖分是等价的
## 超越卡特兰数

- 超越卡特兰数将二叉结构推广到 $s$ 叉结构
$$C_{n}^{(s)}=\frac{1}{(s-1)n+1} \binom{sn}{n}$$
- 当 $s=2$ 时，该式子退化为标准卡特兰公式
- 比如 $C_{n}^{(s)}$ 计数了一个凸多边形用不相交的对角线分割成 $(s+1)$ 边形的方法数
# 斯特林数 

## 第一类斯特林数

- **有符号第一类斯特林数**：记作 $s(n,k)$ ，被定义为**下降阶乘** $(x)_{n}=x(x-1)\ldots(x-n+1)$ 展开成关于 $x$ 的多项式时的系数
$$(x)_{n}=\sum\limits_{k=0}^{n} s(n,k)x^{k}$$
- **无符号第一类斯特林数**：记作 $c(n,k)$ 或者 $\left[\begin{matrix}n\\k\end{matrix}\right]$ ，被定义为**上升阶乘** $x^{(n)}=x(x+1)\ldots(x+n-1)$ 展开成关于 $x$ 的多项式时的系数
$$x^{(n)}=\sum\limits_{k=0}^{n}c(n,k)x^{k}$$
- 有以下关系，我们一般关注的是无符号斯特林数
$$s(n,k)=(-1)^{n-k}c(n,k)$$
### 组合定义

- 无符号第一类斯特林数的核心组合意义是：将 $n$ 个可区分的元素排列成 $k$ 个非空、不可区分的轮换（或者圆排列）的方法数
- 或者我们换个说法，就是把 $n$ 个人安排到 $k$ 张完全相同的桌子上，要求每个桌子都有人坐的方案数
### 基本递推关系
 
- 有以下递推关系：
$$c(n,k)=(n-1)c(n-1,k)+c(n-1,k-1)$$
- 我们考虑第 $n$ 个新元素：
	- 自成一个新轮换：前 $n-1$ 个元素构成 $k-1$ 个轮换。第 $n$ 个元素独立，方案数为 $c(n-1,k-1)$ 
	- 加入现有轮换：前 $n-1$ 个元素构成 $k$ 个轮换，第 $n$ 个元素可以插入到这 $n-1$ 个元素中任意一个的后边，共有 $n-1$ 个可插入位置，方案数为 $(n-1)c(n-1,k)$ 
### 性质

- $c(n,0)=0$ 对于 $n>0$ ，但 $c(0,0)=1$
- $c(n,n)=1$ ，每个元素自成一个轮换
- $c(n,1)=(n-1)!$ ，所有元素构成一个大轮换
- $c(n,n-1)=C(n,2)$ ，必然是 $n-2$ 个元素自成轮换，另外两个元素构成一个二元轮换，选择这两个元素的方案是 $C(n,2)$ 
- $\sum\limits_{k=0}^{n} c(n,k)=n!$ ，对所有可能的轮换数求和，即得到所有 $n$ 个元素的全排列数
## 第二类斯特林数

- 第二类斯特林数，记作 $S(n,k)$ 或 $\left\{\begin{matrix}n\\k\end{matrix}\right\}$ ，其代数定义与第一类斯特林数互补，它们是普通幂 $x^{n}$ 展开成下降阶乘 $(x)_{k}$ 级数时的系数
$$x^{n}=\sum\limits_{k=0}^{n} S(n,k)(x)_{k}$$
- 这一定义揭示了它在多项式基底变换中作为前者的**逆矩阵**的性质
### 组合定义

- 将一个包含 $n$ 个可区分元素的集合，划分成 $k$ 个非空、不可区分的子集的方案数
- 相当于把 $n$ 个人安排到 $k$ 个房间，要求每个房间非空
### 基本递推关系

$$S(n,k)=kS(n-1,k)+S(n-1,k-1)$$
- 类似第一类可推出
### 显示求和公式

$$S(n,k)= \frac{1}{k!}\sum\limits_{i=0}^{k}(-1)^{k-i}C(k,i)i^{n}$$
- 此式子时基于容斥原理推出
- 我们先考虑将 $n$ 个可区分的球放入 $k$ 个可区分的盒子，允许空盒，共有 $k^{n}$ 种方法，然后利用容斥原理，减去至少有一个空盒子的方法，加上至少有两个盒子为空的情况，以此类推，得到了将 $n$ 个球放入 $k$ 个可区分且非空的盒子的方案数，最后除以 $k!$ ，因为子集是不可区分的
### 性质

- $S(n,0)=0$ 对于 $n>0$ ，$S(0,0)=1$
- $S(n,n)=1$ ，每个元素自成一个子集
- $S(n,1)=1$ ，所有元素在一个子集中
- $S(n,2)=2^{n-1}-1$
- $S(n,n-1)=C(n,2)$ ，类似第一类斯特林数
## 生成函数

- **第一类斯特林数（行生成函数）**：对于固定的 $n$ ，无符号第一类斯特林数的普通生成函数就是上升阶乘
$$\sum\limits_{k=0}^{n}c(n,k)x^{k}=\prod_{i=0}^{n-1}(x+i)$$
- **第一类斯特林数（列生成函数）**：对于固定的 $k$ ，无符号第一类斯特林数的普通生成函数为
$$ \sum_{n=k}^{\infty} c(n, k) \frac{x^n}{n!} = \frac{1}{k!} \left( \ln\left(\frac{1}{1-x}\right) \right)^k $$
- **第二类斯特林数（列生成函数）**：对于固定的 $k$ ，第二类斯特林数的指数生成函数为
$$\sum\limits_{n=k}^{\infty}S(n,k) \frac{x^{n}}{n!}= \frac{(e^{x}-1)^{k}}{k!}$$
- 这些生成函数恒等式直接揭示了他们的计算方法

## 计算

### 计算一行斯特林数

- **第一类斯特林数** $c(n,k)$ ：
	- 根据生成函数 $F_{n}(x)=\sum\limits_{k=0}^{n} c(n,k)x^{k}=\prod_{i=0}^{n-1}(x+i)$ ，我们递归分治来计算，本质是多项式函数的卷积，我们用 $\mathbf{NTT}$ 来解决
- **第二类斯特林数** $S(n,k)$ ：
	- 根据显式公式：$S(n,k)=\sum\limits_{i=0}^{k} \frac{i^{n}}{i!}\cdot \frac{(-1)^{k-i}}{(k-i)!}$ 
	- 本质是一个卷积，我们设两个多项式 $A(x)=\sum\limits_{i=0}^{n} \frac{i^{n}}{i!}x^{i}$ 与 $B(x)=\sum\limits_{j=0}^{n} \frac{(-1)^{j}}{j!} x^{j}$ ，那么它们的卷积 $C(x)=A(x)B(x)$ 的第 $k$ 项系数就是 $S(n,k)$ ，我们构造多项式然后 $\mathbf{NTT}$ 即可

### 有关 $k$ 次幂求和

$$\sum\limits_{i=0}^{n} f(i)\cdot i^{k}$$
- 我们可以利用第二类斯特林数的代数恒等式进行转换
$$ \sum_{i=0}^{n} f(i) \cdot i^k = \sum_{i=0}^{n} f(i) \left( \sum_{j=0}^{k} S(k, j) (i)_j \right) = \sum_{j=0}^{k} S(k, j) \left( \sum_{i=0}^{n} f(i) (i)_j \right) $$
### 斯特林反演

- 既然我们说过第一类斯特林数与第二类斯特林数之间存在互补关系，既有容斥关系，那么我们就可以反演
$$g_{n}=\sum\limits_{k=0}^{n}S(n,k)f_{k} \leftrightarrow f_{n}=\sum\limits_{k=0}^{n}c(n,k)g_{k}$$
# 贝尔数

# 伯努利数

# Pólya 计数

# 图论计数
