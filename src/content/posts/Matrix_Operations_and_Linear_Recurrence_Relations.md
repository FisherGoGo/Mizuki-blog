---
title: 矩阵运算与线性递推
published: 2025-07-27
tags: [MATH]
category: Knowledge
draft: false
---

# 线性递推

- 一个序列 $f$ ，如果其第 $n$ 项可以表示为前 $k$ 项的线性组合，那么他就是 $k$ 阶线性递推序列
$$f(n)=c_{1}f(n-1)+c_{2}f(n-2)+c_{3}f(n-3)+...+c_{k}f(n-k)$$
- 其中 $c_{1},c_{2}...$ 为常数，著名例子就是斐波那契数列 $F(n)=F(n-1)+F(n-2)$ 

# 用矩阵表示递推

- 我们要构造一个**状态向量**和**转移矩阵**来实现
	- 状态向量：包含足够的信息来推出下一个状态，通常选择包含 $f(n-1),...,f(n-k)$ 的 $k$ 维向量
	- 转移矩阵：一个 $k\times k$ 的矩阵，当它左乘当前的状态向量时，能得到下一个状态的向量

## 构建矩阵

- 一般至少包含序列的前 $k$ 项，如果还包含其他的变量，也要加上，基础的为：
$$\vec{v_{n}}=[f(n-1),f(n-2),...,f(n-k)]^{T}$$
- 还有目标状态向量，通常是将前一个都向前推一步
$$\vec{v_{n+1}}=[f(n),f(n-1),f(n-2),...,f(n-k+1)]^{T}$$
- 接下来我们要用当前状态来表示下一个状态，我们有
$$\begin{cases}f(n)=c_{1}f(n-1)+c_{2}f(n-2)+...+c_{k}f(n-k)\\\\ f(n-1)=1\cdot f(n-1)+0\cdot f(n-2)+...\\\\ f(n-2)=0\cdot f(n-1)+1\cdot f(n-2)+...\\\\...\end{cases}$$
- 这样子我们就可以构造出矩阵
$$M=\begin{vmatrix}c_{1}&c_{2}&c_{3}&...&c_{k}\\1&0&0&...&0\\0&1&0&...&0\\0&0&1&...&0\\.&.&.&.&.\\0&0&0&...&1\end{vmatrix}$$
- 那么就有 $\vec{v_{n+1}}=M\cdot \vec{v_{n}}$ ，$\vec{v_{m}}=M^{m}\vec{v_{0}}$ 

## 计算

- 一般来说我们存储的 $\vec{v}$ 是行向量，既 $\vec{v^{T}}$ ，那么计算的时候要用 $M^{T}$
- 计算行向量与矩阵乘法时，我们这样子计算 $g$ 行向量与 $F$ 矩阵的乘积
$$G_{j}=\sum\limits_{i=0}^{n-1}g_{i}\cdot F_{ij}$$